import pandas as pd
import webbrowser

# https://twitter.com/peckshield

df = pd.read_csv("data/exploits.csv")
# removes duplicate rows
df = df.drop_duplicates(subset=["URL"])

toAnalize = df[df["tx"].notnull()]
toAnalize = toAnalize[toAnalize["tx"] != "skipped"]
for i, row in toAnalize.iterrows():
    print(i, row["URL"], row["tx"], "", sep="\n")

# exit(0)
for i, row in df[df["tx"].isnull()].iterrows():
    url = row["URL"]
    print(*row.values[:-1], sep="\n")
    webbrowser.open_new_tab(url)
    tx = input("Enter tx: ")
    if tx == str():
        tx = "skipped"
    df.at[i, "tx"] = tx
    df.to_csv("data/exploits.csv", index=False)
